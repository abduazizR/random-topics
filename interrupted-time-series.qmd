---
title: "Untitled"
format: html
editor: visual
bibliography: references.bib
---

# About

This file is an attempt to implement the examples in [@bernal2017].

# Packages

```{r}
pacman::p_load(tidyverse, lubridate)
```

# Data description

From the paper "The example dataset used in this paper is taken from a study by Barone-Adesi et al. on the effects of the Italian smoking ban in public places on hospital admissions for acute coronary events (ACEs, ICD10 410-411). In January 2005, Italy introduced regulations to ban smoking in all indoor public places, with the aim of limiting the adverse health effects of second-hand smoke. The subset used here are ACEs in the Sicily region between 2002 and 2006 among those aged 0-69 years. This dataset is available in Supplementary Appendix 1 with an excerpt presented in Table 1 and represented graphically in Figure 1. This example is not meant to contribute to the substantive evidence on the topic, rather to illustrate the methods. Further details on the dataset can be found in the original publication by Barone-Adesi et al. 2011.16"

```{r}
sicily <- read_csv("interrupted time series files/sicily.csv")
```

# Figure 1

```{r}
sicily <-
  sicily |> 
  mutate(outcome = aces/stdpop*10^5,
         date = ym(paste(year,month,"-"))
         # time2 = ym(paste0(c(year,month), collapse = "-"))
  )

sicily |> 
  ggplot(aes(x = date, y = outcome, color = as_factor(smokban))) + 
  geom_jitter() +
  annotate("rect", xmin = as_date("2005-01-01"), xmax = max(sicily$date), ymin = 150, ymax = 280,
           alpha = .1,fill = "blue")

sicily |> 
  ggplot(aes(x = date, y = outcome, color = as_factor(smokban))) + 
  geom_jitter() + geom_smooth(method = "lm", se = F) +
  annotate("rect", xmin = as_date("2005-01-01"), xmax = max(sicily$date), ymin = 150, ymax = 280,
           alpha = .1,fill = "blue")
```

# Regression analysis

$$
Y_t = \beta_0+\beta_1+\beta_2X_t+\beta_3(T-T_0)X_t
$$

```{r}

```
